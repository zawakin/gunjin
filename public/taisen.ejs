<!DOCTYPE html>

<html lang="ja" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title><%=title %></title>
    <link href="css/gunjin1_0.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>   
    <script type="text/javascript" src="js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="js/GunjinShogiProgram.js"></script>
    <script type="text/javascript" src="js/gunjin1_0.js"></script>
</head>
<body>
    

    <h1 id="roomNum"><%= roomNum%></h1>
    <div id="nameinput">
        <label>名前を入力してEnter</label>
        <form name="nameform" onsubmit="NameFormEvent(); return false;" >
            <input id="name" type="text" />
        </form>
    </div>

    <div id="waiting" style="display:none;">
        <h1>対戦者が来るのを待っています...</h1>
    </div>

    <div id="battlestart" style="display:none;">
        <h1>対戦者が決定しました</h1>
        <div>
            <label>先手：</label>
            <label id="sente"></label><br />
            <label>後手：</label>
            <label id="gote"></label>
        </div>
    </div>

    <div id="battlejunbi" style="display:none;">
        <header>
            <h1 id="statemsg">初期配置を決めてください。</h1>
        </header>

        <article>
            <!--  <div id="draggable" style="width:500px;height:500px;background-color:green;"></div>-->
            <div style="display:none;">
                <canvas class="cell" width="67" height="67"></canvas>
                <canvas class="shireibu cell" width="135" height="67"></canvas>
                <canvas class="emphasis" width="67" height="67"></canvas>
            </div>
            <h1></h1>
            <button id="change" class="haitimode">配置をやり直す</button>
            <button id="haitikettei" class="haitimode" style="color:red;">配置決定</button>
            <div id="board">
                <canvas id="field" width="412" height="626"></canvas>
                <div id="komagote" class="battlemode"></div>
                <div id="infobox" class="battlemode">
                    <label style="top:0px;">後手</label>
                    <label style="top:132px;">先手</label>
                </div>
                <div id="komasente" class="battlemode"></div>

            </div>

            <div id="komadai" class="haitimode">
                <!-- ここに2x12のcanvasを配置して駒の画像を表示する -->
            </div>
        </article>

        <footer>
            ©hoge
        </footer>
    </div>

    <div id="battle" style="display:none;">

    </div>
    <div id="battlefinish" style="display:none;">


    </div>

    <script>
        
        var stage = 0;
        var waiting = false;

        var socket = io();
        

        function NameFormEvent() {
            var name = document.forms.nameform.name.value;
            var roomNum = document.getElementById("roomNum").textContent;

            var data = { name: name ,roomNum:roomNum};
            socket.emit("taisenmachi", data);
            $("#nameinput").hide();
            $("#waiting").show();
            waiting = true;
        };

        socket.on("SENGO", function (sengo) {
            socket.mySengo = sengo;
        });

        socket.on("taisenKettei", function (game) {
            
            if (waiting) {

                $("#waiting").hide();
                $("#sente").text(game.sente.name);
                $("#gote").text(game.gote.name);
                $("#battlestart").show();



                window.setTimeout(function (game) {
                    $("#battlestart").hide();
                    $("#battlejunbi").show();
                }, 2000, game
                );

            }
        });

        
    </script>
</body>
</html>